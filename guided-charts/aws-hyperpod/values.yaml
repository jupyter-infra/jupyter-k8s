# [AWS HYPERPOD]: Configuration for aws-hyperpod deployment mode
# This includes presigned URL and remote access setup

namespace: jupyter-k8s-system

# [CLUSTER WEB UI]: Web interface configuration
clusterWebUI:
  enabled: false

  # Full domain for the application (required)
  domain: ""

  # AWS Certificate Manager ARN for SSL/TLS termination at load balancer
  awsCertificateArn: ""

  # External DNS configuration
  externalDns:
    enabled: true

  # Network policy configuration
  networkPolicy:
    enabled: true

  # [TRAEFIK]: Reverse proxy configuration
  traefik:
    shouldInstall: false
    repository: public.ecr.aws/docker/library
    imageName: traefik
    imageTag: latest
    replicas: 2
    redirectHttp: true
    debug: false
    allowCrossNamespace: true

  # Authentication middleware configuration
  auth:
    replicas: 2
    imagePullPolicy: Always
    repository: docker.io
    imageName: jupyter-k8s-auth
    imageTag: latest
    resources:
      limits:
        cpu: 200m
        memory: 256Mi
      requests:
        cpu: 200m
        memory: 256Mi
    jwtSigningType: "kms"
    kmsKeyId: ""
    jwtIssuer: "jupyter-k8s-auth"
    jwtAudience: "workspace-users"
    jwtExpiration: "12h"
    jwtRefreshWindow: "15m"
    jwtRefreshHorizon: "12h"
    cookieName: "workspace_auth"
    cookieSecure: "true"
    cookiePath: "/"
    cookieMaxAge: "24h"
    cookieHttpOnly: "true"
    cookieSameSite: "lax"
    pathRegexPattern: "^(/).*$"
    routingMode: "subdomain"
    workspaceNameSubdomainRegex: "^([^-]+)-.*$"
    workspaceNamespaceSubdomainRegex: "^[^-]+-(.*)$"
    maxCookiePaths: "20"
    readTimeout: "10s"
    writeTimeout: "10s"
    shutdownTimeout: "30s"
    oauthEnabled: false
    enableBearerAuth: true
    enableRefresh: false

# Remote access configuration
remoteAccess:
  enabled: false
  ssmManagedNodeRole: ""
  ssmSidecarImage:
    containerRegistry: ""
    repository: ""
    tag: ""
  ssmDocumentName: "AWS-StartSSHSession"

# [STORAGE] StorageClasses for Workspaces
storageClass:
  ebs:
    create: true
    name: sagemaker-spaces-default-storage-class
    isDefault: false
    provisioner: ebs.csi.aws.com
    reclaimPolicy: Delete
    volumeBindingMode: WaitForFirstConsumer
    parameters:
      type: gp3
      fsType: ext4
      encrypted: "true"

# Traefik subchart configuration
traefik:
  service:
    enabled: false
  ingressClass:
    enabled: false
  deployment:
    enabled: false
